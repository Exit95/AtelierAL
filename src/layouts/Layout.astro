---
interface Props {
	title: string;
	description: string;
	image?: string;
	type?: 'website' | 'article' | 'product';
	publishedTime?: string;
	modifiedTime?: string;
	noindex?: boolean;
}

const {
	title,
	description,
	image,
	type = 'website',
	publishedTime,
	modifiedTime,
	noindex = false
} = Astro.props;

// Robust URL handling
const site = Astro.site || new URL('https://atelierkl.de');
const pathname = Astro.url.pathname;

const canonicalURL = new URL(pathname, site).toString();
const socialImage = new URL(image || "/logo-kl.png", site).toString();

// Site info for structured data
const siteInfo = {
	name: "ATELIER KL",
	legalName: "ATELIER KL - Katharina Lanvermann",
	url: site.toString(),
	logo: new URL("/logo-kl.png", site).toString(),
	description: "Abstraktes Kunst-Atelier für einzigartige Kunstwerke und kreative Workshops in Heek",
	address: {
		street: "Bockhorn 68",
		city: "Ahaus",
		postalCode: "48683",
		country: "DE"
	},
	email: "studio@atelierkl.de",
	sameAs: [] // Social media links can be added here
};

import Header from "../components/Header.astro";
import Footer from "../components/Footer.astro";
import Lightbox from "../components/Lightbox.astro";
import "../styles/global.css";
---

<!doctype html>
<html lang="de">
	<head>
		<meta charset="UTF-8" />
		<meta name="viewport" content="width=device-width, initial-scale=1.0" />

		<!-- Favicon -->
		<link rel="icon" type="image/x-icon" href="/favicon.ico" />
		<link rel="icon" type="image/png" sizes="32x32" href="/favicon-32.png" />
		<link rel="icon" type="image/png" sizes="16x16" href="/favicon-16.png" />
		<link rel="apple-touch-icon" sizes="180x180" href="/apple-touch-icon.png" />
		<link rel="manifest" href="/site.webmanifest" />
		<meta name="theme-color" content="#1a1a1a" />

		<!-- Canonical & Language -->
		<link rel="canonical" href={canonicalURL} />
		<meta name="language" content="de" />
		<link rel="alternate" hreflang="de" href={canonicalURL} />

		<!-- Robots -->
		{noindex ? (
			<meta name="robots" content="noindex, nofollow" />
		) : (
			<meta name="robots" content="index, follow, max-image-preview:large, max-snippet:-1, max-video-preview:-1" />
		)}

		<!-- Preconnect for Performance -->
		<link rel="preconnect" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://fonts.gstatic.com" crossorigin />
		<link rel="dns-prefetch" href="https://fonts.googleapis.com" />
		<link rel="preconnect" href="https://use.typekit.net" crossorigin />

		<!-- Adobe Fonts (Greycliff CF) -->
		<link rel="stylesheet" href="https://use.typekit.net/qwk6pil.css" />

		<!-- Google Fonts -->
		<link href="https://fonts.googleapis.com/css2?family=Outfit:wght@100;200;300;400;500;600;700;800;900&family=Cormorant+Garamond:ital,wght@0,400;0,500;1,400;1,500&family=Dancing+Script:wght@400;500;600&family=Playfair+Display:wght@400;500;600;700&family=Lato:wght@300;400;700&display=swap" rel="stylesheet" />

		<!-- Primary SEO Meta Tags -->
		<title>{title} | ATELIER KL - Abstrakte Kunst & Workshops</title>
		<meta name="description" content={description} />
		<meta name="author" content="Katharina Lanvermann" />
		<meta name="keywords" content="abstrakte Kunst, Kunstwerke, Acrylmalerei, Workshops, Kreativkurse, Auftragsarbeit, Kunst kaufen, Heek, Ahaus, Münsterland" />
		<meta name="generator" content={Astro.generator} />

		<!-- Open Graph / Facebook -->
		<meta property="og:type" content={type} />
		<meta property="og:url" content={canonicalURL} />
		<meta property="og:title" content={`${title} | ATELIER KL`} />
		<meta property="og:description" content={description} />
		<meta property="og:image" content={socialImage} />
		<meta property="og:image:width" content="1200" />
		<meta property="og:image:height" content="630" />
		<meta property="og:locale" content="de_DE" />
		<meta property="og:site_name" content="ATELIER KL" />
		{publishedTime && <meta property="article:published_time" content={publishedTime} />}
		{modifiedTime && <meta property="article:modified_time" content={modifiedTime} />}

		<!-- Twitter -->
		<meta name="twitter:card" content="summary_large_image" />
		<meta name="twitter:url" content={canonicalURL} />
		<meta name="twitter:title" content={`${title} | ATELIER KL`} />
		<meta name="twitter:description" content={description} />
		<meta name="twitter:image" content={socialImage} />

		<!-- JSON-LD Structured Data - Organization -->
		<script
			type="application/ld+json"
			set:html={JSON.stringify({
				"@context": "https://schema.org",
				"@type": "ArtGallery",
				"@id": siteInfo.url + "#organization",
				name: siteInfo.name,
				legalName: siteInfo.legalName,
				url: siteInfo.url,
				logo: {
					"@type": "ImageObject",
					url: siteInfo.logo,
					width: 512,
					height: 512
				},
				image: socialImage,
				description: siteInfo.description,
				address: {
					"@type": "PostalAddress",
					streetAddress: siteInfo.address.street,
					addressLocality: siteInfo.address.city,
					postalCode: siteInfo.address.postalCode,
					addressCountry: siteInfo.address.country
				},
				email: siteInfo.email,
				priceRange: "€€",
				openingHoursSpecification: {
					"@type": "OpeningHoursSpecification",
					dayOfWeek: ["Monday", "Tuesday", "Wednesday", "Thursday", "Friday"],
					opens: "10:00",
					closes: "18:00"
				},
				sameAs: siteInfo.sameAs
			})}
		/>

		<!-- JSON-LD Structured Data - WebSite -->
		<script
			type="application/ld+json"
			set:html={JSON.stringify({
				"@context": "https://schema.org",
				"@type": "WebSite",
				"@id": siteInfo.url + "#website",
				url: siteInfo.url,
				name: siteInfo.name,
				description: siteInfo.description,
				publisher: {
					"@id": siteInfo.url + "#organization"
				},
				potentialAction: {
					"@type": "SearchAction",
					target: {
						"@type": "EntryPoint",
						urlTemplate: siteInfo.url + "/werke?q={search_term_string}"
					},
					"query-input": "required name=search_term_string"
				},
				inLanguage: "de-DE"
			})}
		/>

		<!-- JSON-LD Structured Data - BreadcrumbList -->
		<script
			type="application/ld+json"
			set:html={JSON.stringify({
				"@context": "https://schema.org",
				"@type": "BreadcrumbList",
				itemListElement: [
					{
						"@type": "ListItem",
						position: 1,
						name: "Home",
						item: siteInfo.url
					},
					...(pathname !== "/" ? [{
						"@type": "ListItem",
						position: 2,
						name: title,
						item: canonicalURL
					}] : [])
				]
			})}
		/>
	</head>
	<body>
		<a href="#main-content" class="skip-to-content"
			>Zum Hauptinhalt springen</a
		>

		<Header />

		<main id="main-content">
			<slot />
		</main>

		<Footer />
		<Lightbox images={[]} />

		<!-- Vercel Web Analytics -->
		<script is:inline>
			if (window.va) window.va("pageview");
		</script>
	</body>
</html>
