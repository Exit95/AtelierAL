import { f as createAstro, c as createComponent, b as renderTemplate, g as defineScriptVars, r as renderComponent, m as maybeRenderHead, d as addAttribute } from '../../../chunks/astro/server_DD7gXx_F.mjs';
import 'piccolore';
import { $ as $$AdminLayout } from '../../../chunks/AdminLayout_CXfHe3il.mjs';
import { g as getEntry } from '../../../chunks/_astro_content_BW2y2Sn-.mjs';
/* empty css                                      */
export { renderers } from '../../../renderers.mjs';

var __freeze = Object.freeze;
var __defProp = Object.defineProperty;
var __template = (cooked, raw) => __freeze(__defProp(cooked, "raw", { value: __freeze(raw || cooked.slice()) }));
var _a;
const $$Astro = createAstro("https://test-danapfel-digital.de");
const $$id = createComponent(async ($$result, $$props, $$slots) => {
  const Astro2 = $$result.createAstro($$Astro, $$props, $$slots);
  Astro2.self = $$id;
  const { id } = Astro2.params;
  const workshop = id ? await getEntry("workshops", id) : null;
  if (!workshop) {
    return Astro2.redirect("/admin/workshops");
  }
  const data = workshop.data;
  const dateStr = new Date(data.date).toISOString().split("T")[0];
  const materialsStr = Array.isArray(data.materials) ? data.materials.join("\n") : "";
  return renderTemplate(_a || (_a = __template(["", " <script>(function(){", '\n    const form = document.getElementById("workshopForm");\n    const messageDiv = document.getElementById("message");\n\n    form?.addEventListener("submit", async (e) => {\n        e.preventDefault();\n        messageDiv.textContent = "";\n\n        const formData = new FormData(form);\n        const data = Object.fromEntries(formData.entries());\n\n        try {\n            const res = await fetch(`/api/workshops/${workshopId}/update`, {\n                method: "PUT",\n                headers: { "Content-Type": "application/json" },\n                body: JSON.stringify(data),\n            });\n\n            const result = await res.json();\n\n            if (result.success) {\n                messageDiv.textContent = "Workshop erfolgreich aktualisiert!";\n                messageDiv.className = "message success";\n                setTimeout(\n                    () => (window.location.href = "/admin/workshops"),\n                    1500,\n                );\n            } else {\n                messageDiv.textContent =\n                    result.error || "Fehler beim Speichern";\n                messageDiv.className = "message error";\n            }\n        } catch (e) {\n            messageDiv.textContent = "Fehler beim Speichern der \xC4nderungen";\n            messageDiv.className = "message error";\n        }\n    });\n})();<\/script> '], ["", " <script>(function(){", '\n    const form = document.getElementById("workshopForm");\n    const messageDiv = document.getElementById("message");\n\n    form?.addEventListener("submit", async (e) => {\n        e.preventDefault();\n        messageDiv.textContent = "";\n\n        const formData = new FormData(form);\n        const data = Object.fromEntries(formData.entries());\n\n        try {\n            const res = await fetch(\\`/api/workshops/\\${workshopId}/update\\`, {\n                method: "PUT",\n                headers: { "Content-Type": "application/json" },\n                body: JSON.stringify(data),\n            });\n\n            const result = await res.json();\n\n            if (result.success) {\n                messageDiv.textContent = "Workshop erfolgreich aktualisiert!";\n                messageDiv.className = "message success";\n                setTimeout(\n                    () => (window.location.href = "/admin/workshops"),\n                    1500,\n                );\n            } else {\n                messageDiv.textContent =\n                    result.error || "Fehler beim Speichern";\n                messageDiv.className = "message error";\n            }\n        } catch (e) {\n            messageDiv.textContent = "Fehler beim Speichern der \xC4nderungen";\n            messageDiv.className = "message error";\n        }\n    });\n})();<\/script> '])), renderComponent($$result, "AdminLayout", $$AdminLayout, { "title": "Workshop bearbeiten", "data-astro-cid-62bqb7vi": true }, { "default": async ($$result2) => renderTemplate` ${maybeRenderHead()}<form id="workshopForm" class="admin-form" data-astro-cid-62bqb7vi> <div class="form-group" data-astro-cid-62bqb7vi> <label for="title" data-astro-cid-62bqb7vi>Titel*</label> <input type="text" id="title" name="title" required${addAttribute(data.title, "value")} data-astro-cid-62bqb7vi> </div> <div class="form-group" data-astro-cid-62bqb7vi> <label for="description" data-astro-cid-62bqb7vi>Beschreibung*</label> <textarea id="description" name="description" required rows="5" data-astro-cid-62bqb7vi>${data.description}</textarea> </div> <div class="form-row" data-astro-cid-62bqb7vi> <div class="form-group" data-astro-cid-62bqb7vi> <label for="date" data-astro-cid-62bqb7vi>Datum*</label> <input type="date" id="date" name="date" required${addAttribute(dateStr, "value")} data-astro-cid-62bqb7vi> </div> <div class="form-group" data-astro-cid-62bqb7vi> <label for="time" data-astro-cid-62bqb7vi>Uhrzeit*</label> <input type="text" id="time" name="time" required${addAttribute(data.time, "value")} data-astro-cid-62bqb7vi> </div> </div> <div class="form-group" data-astro-cid-62bqb7vi> <label for="duration" data-astro-cid-62bqb7vi>Dauer*</label> <input type="text" id="duration" name="duration" required${addAttribute(data.duration, "value")} data-astro-cid-62bqb7vi> </div> <div class="form-group" data-astro-cid-62bqb7vi> <label for="location" data-astro-cid-62bqb7vi>Ort*</label> <input type="text" id="location" name="location" required${addAttribute(data.location, "value")} data-astro-cid-62bqb7vi> </div> <div class="form-row" data-astro-cid-62bqb7vi> <div class="form-group" data-astro-cid-62bqb7vi> <label for="maxParticipants" data-astro-cid-62bqb7vi>Max. Teilnehmer*</label> <input type="number" id="maxParticipants" name="maxParticipants" required${addAttribute(data.maxParticipants, "value")} data-astro-cid-62bqb7vi> </div> <div class="form-group" data-astro-cid-62bqb7vi> <label for="currentParticipants" data-astro-cid-62bqb7vi>Aktuelle Teilnehmer</label> <input type="number" id="currentParticipants" name="currentParticipants"${addAttribute(data.currentParticipants, "value")} data-astro-cid-62bqb7vi> </div> </div> <div class="form-group" data-astro-cid-62bqb7vi> <label for="price" data-astro-cid-62bqb7vi>Preis (€)*</label> <input type="number" id="price" name="price" step="0.01" required${addAttribute(data.price, "value")} data-astro-cid-62bqb7vi> </div> <div class="form-group" data-astro-cid-62bqb7vi> <label for="image" data-astro-cid-62bqb7vi>Bild-URL*</label> <input type="text" id="image" name="image" required${addAttribute(data.image, "value")} data-astro-cid-62bqb7vi> </div> <div class="form-group" data-astro-cid-62bqb7vi> <label for="materials" data-astro-cid-62bqb7vi>Materialien (eine pro Zeile)*</label> <textarea id="materials" name="materials" rows="5" required data-astro-cid-62bqb7vi>${materialsStr}</textarea> </div> <div class="form-group" data-astro-cid-62bqb7vi> <label data-astro-cid-62bqb7vi> <input type="checkbox" id="bookingEnabled" name="bookingEnabled"${addAttribute(data.bookingEnabled, "checked")} data-astro-cid-62bqb7vi>
Buchung aktiviert
</label> </div> <div class="form-actions" data-astro-cid-62bqb7vi> <a href="/admin/workshops" class="btn btn-secondary" data-astro-cid-62bqb7vi>Abbrechen</a> <button type="submit" class="btn btn-primary" data-astro-cid-62bqb7vi>Änderungen speichern</button> </div> <div id="message" class="message" data-astro-cid-62bqb7vi></div> </form> ` }), defineScriptVars({ workshopId: id }));
}, "/home/exit/Musik/AtelierKL/project/src/pages/admin/workshops/[id].astro", void 0);

const $$file = "/home/exit/Musik/AtelierKL/project/src/pages/admin/workshops/[id].astro";
const $$url = "/admin/workshops/[id]";

const _page = /*#__PURE__*/Object.freeze(/*#__PURE__*/Object.defineProperty({
    __proto__: null,
    default: $$id,
    file: $$file,
    url: $$url
}, Symbol.toStringTag, { value: 'Module' }));

const page = () => _page;

export { page };
