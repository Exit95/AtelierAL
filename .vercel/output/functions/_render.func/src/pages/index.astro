---
import Layout from "../layouts/Layout.astro";
import HeroSection from "../components/HeroSection.astro";
import WorkshopCard from "../components/WorkshopCard.astro";
import CTAButton from "../components/CTAButton.astro";
import Badge from "../components/Badge.astro";
import { getItems, type Artwork, type Workshop } from "../lib/storage";
import { getCollection } from "astro:content"; // Keep for testimonials if they are still static

// Get featured artworks and upcoming workshops
const allArtworks = await getItems<Artwork>("artworks");
const featuredArtworks = allArtworks
	.filter((artwork) => artwork.featured)
	.slice(0, 6);

const allWorkshops = await getItems<Workshop>("workshops");
const upcomingWorkshops = allWorkshops
	.filter((workshop) => new Date(workshop.date) > new Date())
	.sort((a, b) => new Date(a.date).getTime() - new Date(b.date).getTime())
	.slice(0, 3);

const allTestimonials = await getCollection("testimonials");
---

<Layout
	title="Home"
	description="ATELIER KL - Abstrakte Kunst von Katharina Lanvermann. Entdecken Sie einzigartige Kunstwerke und kreative Workshops in Heek."
>
	<HeroSection
		title="Kunst, die Räume verwandelt"
		subtitle="Abstrakte Kunstwerke und inspirierende Workshops von Katharina Lanvermann"
		primaryCTA={{ label: "Werke entdecken", href: "/werke" }}
		secondaryCTA={{ label: "Workshop buchen", href: "/workshops" }}
	/>

	<!-- Artist Introduction -->
	<section class="section py-16">
		<div class="container">
			<div class="intro-grid">
				<div class="intro-text">
					<h2>Über das Atelier</h2>
					<p class="lead-text">
						Willkommen im ATELIER KL – einem Ort, an dem abstrakte
						Kunst entsteht, die Räume mit Farbe, Struktur und
						Emotion zum Leben erweckt.
					</p>
					<p>
						Seit über 10 Jahren erschaffe ich im Herzen von Heek
						einzigartige Kunstwerke, die von natürlichen Elementen,
						mediterranen Landschaften und der Schönheit des
						Einfachen inspiriert sind. Jedes Werk ist ein Unikat,
						geschaffen mit Acrylfarben, Pigmenten und viel
						Leidenschaft.
					</p>
					<p>
						Neben meinen eigenen Werken biete ich auch
						Auftragsarbeiten an, die individuell auf Ihre Räume und
						Wünsche abgestimmt werden. In meinen Workshops können
						Sie selbst zur Künstlerin oder zum Künstler werden und
						Ihre kreative Seite entdecken.
					</p>
					<div class="intro-ctas">
						<CTAButton
							label="Mehr über mich"
							href="/team"
							type="secondary"
						/>
					</div>
				</div>
				<div class="intro-image">
					<img
						src="/katharina-profile.jpg"
						alt="Katharina Lanvermann, Künstlerin von ATELIER KL"
						class="profile-image"
						loading="lazy"
					/>
				</div>
			</div>
		</div>
	</section>

	<!-- Featured Artworks -->
	<section
		class="section py-16"
		style="background-color: var(--color-surface);"
	>
		<div class="container">
			<div class="section-header">
				<h2>Ausgewählte Werke</h2>
				<p class="text-secondary">
					Eine Auswahl meiner neuesten abstrakten Kunstwerke
				</p>
			</div>

			{
				featuredArtworks.length > 0 ? (
					<>
						<div class="grid grid-cols-1 grid-cols-md-2 grid-cols-lg-3">
							{featuredArtworks.map((artwork) => (
								<a
									href={`/werke/${artwork.id}`}
									class="artwork-preview"
								>
									<div class="artwork-preview-image">
										<img
											src={artwork.images[0]}
											alt={artwork.title}
											loading="lazy"
										/>
										<Badge
											variant={artwork.availability}
											label={
												artwork.availability ===
												"available"
													? "Verfügbar"
													: artwork.availability ===
														  "reserved"
														? "Reserviert"
														: "Verkauft"
											}
										/>
									</div>
									<h3 class="artwork-preview-title">
										{artwork.title}
									</h3>
									<p class="artwork-preview-meta">
										{artwork.size.width} ×{" "}
										{artwork.size.height}{" "}
										{artwork.size.unit}
									</p>
								</a>
							))}
						</div>
						<div class="section-cta">
							<CTAButton
								label="Alle Werke ansehen"
								href="/werke"
								type="primary"
							/>
						</div>
					</>
				) : (
					<p class="text-center text-secondary">
						Demnächst finden Sie hier ausgewählte Kunstwerke.
					</p>
				)
			}
		</div>
	</section>

	<!-- Workshops -->
	<section class="section py-16">
		<div class="container">
			<div class="section-header">
				<h2>Workshops, die Kreativität wecken</h2>
				<p class="text-secondary">
					Entdecken Sie Ihre künstlerische Seite in kleinen Gruppen
				</p>
			</div>

			{
				upcomingWorkshops.length > 0 ? (
					<>
						<div class="grid grid-cols-1 grid-cols-md-3">
							{upcomingWorkshops.map((workshop) => (
								<WorkshopCard workshop={workshop} />
							))}
						</div>
						<div class="section-cta">
							<CTAButton
								label="Alle Workshops"
								href="/workshops"
								type="primary"
							/>
						</div>
					</>
				) : (
					<p class="text-center text-secondary">
						Neue Workshops werden in Kürze angekündigt. Schauen Sie
						bald wieder vorbei!
					</p>
				)
			}
		</div>
	</section>

	<!-- Commission Process -->
	<section
		class="section py-16"
		style="background-color: var(--color-surface);"
	>
		<div class="container">
			<div class="section-header text-center">
				<h2>Ihr persönliches Kunstwerk</h2>
				<p class="text-secondary">
					Von der Idee bis zum fertigen Werk in drei Schritten
				</p>
			</div>

			<div class="process-steps">
				<div class="process-step">
					<div class="step-number">01</div>
					<h3>Anfrage & Beratung</h3>
					<p>
						Teilen Sie mir Ihre Vorstellungen, Farbwünsche und
						Raummaße mit. Gemeinsam entwickeln wir ein Konzept für
						Ihr individuelles Kunstwerk.
					</p>
				</div>
				<div class="process-step">
					<div class="step-number">02</div>
					<h3>Konzept & Entwurf</h3>
					<p>
						Ich erstelle einen ersten Entwurf und stimme ihn mit
						Ihnen ab. So stellen wir sicher, dass das Werk perfekt
						zu Ihren Wünschen passt.
					</p>
				</div>
				<div class="process-step">
					<div class="step-number">03</div>
					<h3>Umsetzung & Übergabe</h3>
					<p>
						Ich erschaffe Ihr Kunstwerk mit großer Sorgfalt. Nach
						Fertigstellung können Sie es abholen oder es wird zu
						Ihnen geliefert.
					</p>
				</div>
			</div>

			<div class="section-cta">
				<CTAButton
					label="Jetzt Werk anfragen"
					href="/auftragsarbeiten"
					type="primary"
				/>
			</div>
		</div>
	</section>

	<!-- Testimonials -->
	{
		allTestimonials.length > 0 && (
			<section class="section py-16">
				<div class="container">
					<div class="section-header text-center">
						<h2>Das sagen Kunden</h2>
					</div>

					<div class="testimonials-grid">
						{allTestimonials.slice(0, 3).map((testimonial) => (
							<div class="testimonial-card">
								<div class="testimonial-stars">
									{Array.from({
										length: testimonial.data.rating,
									})
										.map(() => "⭐")
										.join("")}
								</div>
								<p class="testimonial-text">
									"{testimonial.data.text}"
								</p>
								<div class="testimonial-author">
									<strong>{testimonial.data.author}</strong>
									{testimonial.data.role && (
										<span>{testimonial.data.role}</span>
									)}
								</div>
							</div>
						))}
					</div>
				</div>
			</section>
		)
	}

	<!-- Final CTA -->
	<section
		class="section py-16"
		style="background: linear-gradient(135deg, var(--color-brand-beige), var(--color-brand-beige-dark));"
	>
		<div class="container text-center">
			<h2 style="color: var(--color-white);">
				Bereit für Ihr eigenes Kunstwerk?
			</h2>
			<p
				style="color: var(--color-white); opacity: 0.9; max-width: 600px; margin: var(--space-4) auto var(--space-8);"
			>
				Kontaktieren Sie mich für eine unverbindliche Beratung oder
				buchen Sie einen Workshop.
			</p>
			<div class="flex gap-4 justify-center" style="flex-wrap: wrap;">
				<CTAButton
					label="Kontakt aufnehmen"
					href="/kontakt"
					type="primary"
				/>
				<CTAButton
					label="Workshops ansehen"
					href="/workshops"
					type="secondary"
				/>
			</div>
		</div>
	</section>
</Layout>

<style>
	.section {
		width: 100%;
	}

	.section-header {
		text-align: center;
		margin-bottom: var(--space-12);
	}

	.section-header h2 {
		margin-bottom: var(--space-3);
	}

	.section-cta {
		display: flex;
		justify-content: center;
		margin-top: var(--space-12);
	}

	.intro-grid {
		display: grid;
		grid-template-columns: 1fr;
		gap: var(--space-8);
		align-items: center;
	}

	@media (min-width: 768px) {
		.intro-grid {
			gap: var(--space-10);
		}
	}

	@media (min-width: 1024px) {
		.intro-grid {
			grid-template-columns: 1.2fr 1fr;
			gap: var(--space-12);
		}
	}

	.intro-text {
		max-width: 650px;
	}

	.lead-text {
		font-size: var(--font-size-xl);
		color: var(--color-text-secondary);
		line-height: var(--line-height-relaxed);
		margin-bottom: var(--space-6);
	}

	.intro-ctas {
		margin-top: var(--space-8);
	}

	.placeholder-image {
		width: 100%;
		border-radius: var(--radius-lg);
	}

	.artwork-preview {
		display: block;
		text-decoration: none;
		color: inherit;
		transition: transform var(--transition-base);
	}

	.artwork-preview:hover {
		transform: translateY(-4px);
	}

	.artwork-preview-image {
		position: relative;
		margin-bottom: var(--space-4);
	}

	.artwork-preview-title {
		font-size: var(--font-size-lg);
		margin-bottom: var(--space-2);
	}

	.artwork-preview-meta {
		font-size: var(--font-size-sm);
		color: var(--color-text-secondary);
	}

	.process-steps {
		display: grid;
		grid-template-columns: 1fr;
		gap: var(--space-6);
		margin-bottom: var(--space-8);
	}

	@media (min-width: 768px) {
		.process-steps {
			grid-template-columns: repeat(3, 1fr);
			gap: var(--space-8);
		}
	}

	.process-step {
		text-align: center;
		padding: var(--space-6);
	}

	.step-number {
		font-family: var(--font-headline);
		font-size: var(--font-size-4xl);
		font-weight: var(--font-weight-bold);
		color: var(--color-brand-beige);
		margin-bottom: var(--space-4);
	}

	.process-step h3 {
		margin-bottom: var(--space-3);
	}

	.testimonials-grid {
		display: grid;
		grid-template-columns: 1fr;
		gap: var(--space-4);
	}

	@media (min-width: 768px) {
		.testimonials-grid {
			grid-template-columns: repeat(2, 1fr);
			gap: var(--space-6);
		}
	}

	@media (min-width: 1024px) {
		.testimonials-grid {
			grid-template-columns: repeat(3, 1fr);
		}
	}

	.testimonial-card {
		padding: var(--space-6);
		background-color: var(--color-surface-elevated);
		border-radius: var(--radius-lg);
		box-shadow: var(--shadow-base);
	}

	.testimonial-stars {
		font-size: var(--font-size-lg);
		margin-bottom: var(--space-4);
	}

	.testimonial-text {
		font-style: italic;
		line-height: var(--line-height-relaxed);
		margin-bottom: var(--space-4);
	}

	.testimonial-author {
		display: flex;
		flex-direction: column;
		gap: var(--space-1);
	}

	.testimonial-author span {
		font-size: var(--font-size-sm);
		color: var(--color-text-secondary);
	}
</style>
